<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="CONTENT-TYPE" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="payme.css">
    <title>Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ - PayMe</title>
</head>
<body>
    <div class="auth-container">
        <div class="auth-form">
            <h2>Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯ ÙÙŠ PayMe</h2>
            
            <div class="input-group">
                <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: *</label>
                <input type="text" id="username" placeholder="Ø§Ø®ØªØ± Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù… ÙØ±ÙŠØ¯">
                <small class="input-hint">Ø³ÙŠØ³ØªØ®Ø¯Ù… Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</small>
            </div>
            
            <div class="input-group">
                <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: *</label>
                <input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ù‚ÙˆÙŠØ© (6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)">
                <small class="input-hint">ÙŠØ¬Ø¨ Ø£Ù† ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„</small>
            </div>
            
            <div class="input-group">
                <label>ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: *</label>
                <input type="password" id="confirmPassword" placeholder="Ø£Ø¹Ø¯ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
                <small class="input-hint">ÙŠØ¬Ø¨ Ø£Ù† ØªØ·Ø§Ø¨Ù‚ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</small>
            </div>
            
            <div class="input-group">
                <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</label>
                <input type="email" id="email" placeholder="example@email.com (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
            </div>
            
            <div class="input-group">
                <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</label>
                <input type="tel" id="phone" placeholder="09XXXXXXXX (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
            </div>
            
            <div class="terms-group">
                <input type="checkbox" id="agreeTerms">
                <label for="agreeTerms">Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ <a href="#" onclick="showTerms()">Ø´Ø±ÙˆØ· Ø§Ù„Ø®Ø¯Ù…Ø© ÙˆØ³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</a></label>
            </div>
            
            <button class="auth-btn" id="registerBtn">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨</button>
            <button class="auth-link" onclick="showLogin()">Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù„ÙØ¹Ù„ØŸ Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
            
            <div id="authMessage" class="message"></div>
            
            <div class="benefits">
                <h3>Ù…Ù…ÙŠØ²Ø§Øª Ø­Ø³Ø§Ø¨ PayMe:</h3>
                <ul>
                    <li>ğŸ’° ØªØ­ÙˆÙŠÙ„ Ø¹Ù…Ù„Ø§Øª ÙÙˆØ±ÙŠ</li>
                    <li>ğŸ’³ Ø³Ø­Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¨Ù†ÙƒÙŠØ©</li>
                    <li>ğŸ›¡ï¸ Ø£Ù…Ø§Ù† Ù…Ø´ÙØ±</li>
                    <li>ğŸŒ Ø£Ø³Ø¹Ø§Ø± ØµØ±Ù Ø­ÙŠØ©</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        async function register() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const agreeTerms = document.getElementById('agreeTerms').checked;

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            if (!username || !password || !confirmPassword) {
                showMessage('âš ï¸ ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠØ©', 'error');
                return;
            }

            if (password.length < 6) {
                showMessage('âš ï¸ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'error');
                return;
            }

            if (password !== confirmPassword) {
                showMessage('âš ï¸ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©', 'error');
                return;
            }

            if (!agreeTerms) {
                showMessage('âš ï¸ ÙŠØ¬Ø¨ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø´Ø±ÙˆØ· Ø§Ù„Ø®Ø¯Ù…Ø©', 'error');
                return;
            }

            try {
                const response = await fetch('http://localhost:5000/api/auth/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        username: username,
                        password: password,
                        email: email || null,
                        phone: phone || null
                    })
                });

                const data = await response.json();
                
                if (data.success) {
                    // Ø­ÙØ¸ token ÙÙŠ localStorage
                    localStorage.setItem('session_token', data.session_token);
                    localStorage.setItem('user_id', data.user_id);
                    localStorage.setItem('username', username);
                    
                    showMessage('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­! ÙŠØªÙ… ØªÙˆØ¬ÙŠÙ‡Ùƒ Ø§Ù„Ø¢Ù†...', 'success');
                    
                    // ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØªÙŠÙ†
                    setTimeout(() => {
                        window.location.href = 'wallet.html';
                    }, 2000);
                } else {
                    showMessage('âŒ ' + data.message, 'error');
                }
            } catch (error) {
                showMessage('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…', 'error');
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„:', error);
            }
        }

        function validatePassword() {
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const passwordInput = document.getElementById('password');
            const confirmInput = document.getElementById('confirmPassword');

            // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø³Ø§Ø¨Ù‚Ø©
            passwordInput.classList.remove('input-error', 'input-success');
            confirmInput.classList.remove('input-error', 'input-success');

            if (password.length > 0) {
                if (password.length < 6) {
                    passwordInput.classList.add('input-error');
                } else {
                    passwordInput.classList.add('input-success');
                }
            }

            if (confirmPassword.length > 0) {
                if (password !== confirmPassword) {
                    confirmInput.classList.add('input-error');
                } else if (password.length >= 6) {
                    confirmInput.classList.add('input-success');
                }
            }
        }

        function showLogin() {
            window.location.href = 'login.html';
        }

        function showTerms() {
            alert(`Ø´Ø±ÙˆØ· Ø§Ù„Ø®Ø¯Ù…Ø© ÙˆØ³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©:

1. Ø§Ù„Ø£Ù…Ø§Ù†: Ù†Ø­Ù…ÙŠ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªØ´ÙÙŠØ± Ù…ØªÙ‚Ø¯Ù…
2. Ø§Ù„Ø®ØµÙˆØµÙŠØ©: Ù„Ø§ Ù†Ø´Ø§Ø±Ùƒ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ© Ù…Ø¹ Ø£Ø·Ø±Ø§Ù Ø«Ø§Ù„Ø«Ø©
3. Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª: Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª ØªØ®Ø¶Ø¹ Ù„Ù„ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ø£Ù…Ù†ÙŠ
4. Ø§Ù„Ø¯Ø¹Ù…: ÙØ±ÙŠÙ‚ Ø§Ù„Ø¯Ø¹Ù… Ù…ØªØ§Ø­ 24/7 Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©

Ø¨Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ "Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨" ÙØ¥Ù†Ùƒ ØªÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„Ø´Ø±ÙˆØ·.`);
        }

        function showMessage(message, type) {
            const messageDiv = document.getElementById('authMessage');
            messageDiv.textContent = message;
            messageDiv.className = `message ${type}`;
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†Ù Ù„Ù„Ø£Ø®Ø·Ø§Ø¡
            if (type === 'error') {
                setTimeout(() => {
                    messageDiv.textContent = '';
                    messageDiv.className = 'message';
                }, 5000);
            }
        }

        // Ø§Ù„ØªØ­Ù‚Ù‚ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
        function setupRealTimeValidation() {
            document.getElementById('password').addEventListener('input', validatePassword);
            document.getElementById('confirmPassword').addEventListener('input', validatePassword);
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙˆÙØ± Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            document.getElementById('username').addEventListener('blur', async function() {
                const username = this.value.trim();
                if (username.length < 3) {
                    return;
                }
                
                // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù… Ù„Ø§Ø­Ù‚Ø§Ù‹
                console.log('Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:', username);
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('registerBtn').addEventListener('click', register);
            setupRealTimeValidation();
            
            // Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ø²Ø± Enter
            document.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') register();
            });

            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© Ø¥Ù† ÙˆØ¬Ø¯Øª
            const savedUsername = localStorage.getItem('username');
            if (savedUsername) {
                document.getElementById('username').value = savedUsername;
            }
        });
    </script>
</body>
</html>