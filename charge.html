<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="CONTENT-TYPE" content="text/html; charset=UTF-8">
    <title>PayMe Digital Wallet/Wallet/Charge</title>
    <link rel="stylesheet" href="payme4.css">
</head>
<body>
    
    <section class="charge-sect">
        <h2>Charge Your Wallet</h2>
        <label for="currency">Select a currency:</label>
        <select id="currency" name="currency">
            <option value="">-- Please choose --</option>
            <option value="USD" id="usd">US Dollar (USD)</option>
            <option value="USDT" id="usdt">Tether (USDT)</option>
            <option value="IRR" id="irr">Iranian Rial (IRR)</option>
        </select>
        
        <div id="cardSelection" style="display: none;">
            <label for="cards">Select a card:</label>
            <select id="cards" name="card">
                <option value="">-- Please choose --</option>
            </select>
            <button onclick="showAddCardForm()" style="margin-top: 10px; background: #28a745;">Add New Card</button>
        </div>
        
        <!-- Add this section after the card selection dropdown in charge.html -->
        <div id="savedCardsSection" style="display: none; margin-top: 20px;">
            <h4>Your Saved Cards</h4>
            <div id="savedCardsList"></div>
        </div>
        
        <div id="amountSection" style="display: none; margin-top: 20px;">
            <label for="amount">Enter amount:</label>
            <input type="number" id="amount" class="amount-input" placeholder="0.00" min="0" step="0.01">
        </div>
    </section>

<!-- Update the Add Card Form section to include card name -->
    <section id="addCardForm" class="payment-section" style="display: none;">
        <h3>Add New Card</h3>
        <div class="payment-form">
            <input type="text" id="cardName" placeholder="Card Name (Optional)">
            <input type="text" id="newCardNumber" placeholder="Card Number (1234 5678 9012 3456)" maxlength="19">
            <div id="usdCardFields" style="display: none;">
                <div style="display: flex; gap: 10px;">
                    <input type="text" id="newExpiryDate" placeholder="MM/YY" maxlength="5">
                    <input type="text" id="newCvv" placeholder="CVV" maxlength="3">
                </div>
                <input type="text" id="newCardHolder" placeholder="Card Holder Name">
            </div>
            <div id="irrCardFields" style="display: none;">
                <div style="display: flex; gap: 10px;">
                    <input type="text" id="newExpiryDateIRR" placeholder="تاریخ انقضا (MM/YY)" maxlength="5">
                    <input type="text" id="newCvv2" placeholder="CVV2" maxlength="4">
                </div>
            </div>
            <button onclick="addNewCard()">Add Card</button>
            <button onclick="hideAddCardForm()" style="background: #6c757d; margin-top: 5px;">Cancel</button>
        </div>
    </section>
    
    <!-- USD Payment Section -->
    <section id="usdPayment" class="payment-section">
        <h3>USD Payment</h3>
        <div class="payment-form">
            <input type="text" id="cardNumber" placeholder="Card Number (1234 5678 9012 3456)" maxlength="19">
            <div style="display: flex; gap: 10px;">
                <input type="text" id="expiryDate" placeholder="MM/YY" maxlength="5">
                <input type="text" id="cvv" placeholder="CVV" maxlength="3">
            </div>
            <input type="text" id="cardHolder" placeholder="Card Holder Name">
            <button onclick="processUSDPayment()">Pay with Card</button>
        </div>
    </section>
    
    <!-- IRR Payment Section -->
    <section id="irrPayment" class="payment-section">
        <h3>IRR Payment</h3>
        <div class="payment-form" id="irrPaymentForm">
            <div id="irrNewCardFields">
                <select id="irrBank">
                    <option value="">Select Bank</option>
                    <option value="melli">Bank Melli Iran</option>
                    <option value="mellat">Bank Mellat</option>
                    <option value="saderat">Bank Saderat</option>
                    <option value="tejarat">Bank Tejarat</option>
                    <option value="sepah">Bank Sepah</option>
                </select>
                <input type="text" id="irrCardNumber" placeholder="Card Number (16 digits)" maxlength="16">
                <div style="display: flex; gap: 10px;">
                    <input type="text" id="irrExpiryDate" placeholder="تاریخ انقضا (MM/YY)" maxlength="5">
                    <input type="text" id="irrCvv2" placeholder="CVV2" maxlength="4">
                </div>
            </div>
            <div id="irrSavedCardInfo" style="display: none; background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
                <p><strong>Selected Card:</strong> <span id="selectedCardDisplay"></span></p>
            </div>
            <div class="dynamic-code-container">
                <input type="text" id="irrDynamicCode" placeholder="رمز پویا (Dynamic Code)" maxlength="6" class="dynamic-code-input">
                <button onclick="requestDynamicCode()" class="dynamic-code-button">درخواست رمز پویا</button>
            </div>
            <button onclick="processIRRPayment()">Pay with Iranian Card</button>
        </div>
    </section>
    
    <!-- USDT Payment Section -->
    <section id="usdtPayment" class="payment-section">
        <h3>USDT Payment</h3>
        <div class="usdt-info">
            <p><strong>Your USDT Wallet Address:</strong></p>
            <p id="usdtAddress" style="background: #eee; padding: 10px; border-radius: 5px; word-break: break-all;">
                Generating your unique wallet address...
            </p>
            <p><small>Send USDT (TRC20) to this address. Your balance will update after 3 confirmations.</small></p>
        </div>
        <div class="payment-form">
            <p>Or use instant payment:</p>
            <select id="usdtNetwork">
                <option value="TRC20">TRC20 (Recommended)</option>
                <option value="ERC20">ERC20</option>
                <option value="BEP20">BEP20</option>
            </select>
            <button onclick="simulateUSDTPayment()">Simulate USDT Payment</button>
        </div>
    </section>
    
    <div id="message" style="margin: 20px; padding: 10px; border-radius: 5px; display: none;"></div>

    <script src="charge.js"></script>
</body>
</html>